model: mart_orders_enriched

defaults:
  inputs:
    orders:
      csv: tests/fixtures/orders_small.csv
    users_enriched:
      csv: tests/fixtures/users_enriched_small.csv
  expect:
    any_order: true

cases:
  - name: join_and_flag_from_csv
    expect:
      rows:
        - {order_id: 10, user_id: 1, email: "x@gmail.com", is_gmail: true,  amount: 19.9,  valid_amt: true}
        - {order_id: 11, user_id: 1, email: "x@gmail.com", is_gmail: true,  amount: -1.0,  valid_amt: false}
        - {order_id: 12, user_id: 2, email: "a@example.com", is_gmail: false, amount: 0.0,  valid_amt: true}
